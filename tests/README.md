# ARBIGæµ‹è¯•å¥—ä»¶

## ğŸ“ æµ‹è¯•ç›®å½•ç»“æ„

```
tests/
â”œâ”€â”€ README.md                    # æœ¬æ–‡ä»¶ - æµ‹è¯•å¥—ä»¶è¯´æ˜
â”œâ”€â”€ run_all_tests.py            # ä¸»æµ‹è¯•è¿è¡Œå™¨
â”œâ”€â”€ system/                     # ç³»ç»Ÿçº§æµ‹è¯•
â”‚   â”œâ”€â”€ simple_system_test.py   # åŸºç¡€ç³»ç»ŸåŠŸèƒ½æµ‹è¯•
â”‚   â”œâ”€â”€ test_non_trading_functions.py  # éäº¤æ˜“æ—¶é—´åŠŸèƒ½æµ‹è¯•
â”‚   â””â”€â”€ test_service_connection.py     # æœåŠ¡è¿æ¥çŠ¶æ€æµ‹è¯•
â”œâ”€â”€ strategy/                   # ç­–ç•¥ç›¸å…³æµ‹è¯•
â”‚   â””â”€â”€ test_strategy_management.py    # ç­–ç•¥ç®¡ç†ç³»ç»Ÿæµ‹è¯•
â”œâ”€â”€ integration/                # é›†æˆæµ‹è¯•
â”‚   â””â”€â”€ test_gfd_default.py    # GFDé»˜è®¤å‚æ•°å’Œè®¢å•æµ‹è¯•
â””â”€â”€ legacy/                     # é—ç•™æµ‹è¯•æ–‡ä»¶
    â”œâ”€â”€ ctp_connection_test.py
    â”œâ”€â”€ test_account_query.py
    â”œâ”€â”€ test_frontend.py
    â”œâ”€â”€ test_history_query.py
    â”œâ”€â”€ test_order_placement.py
    â””â”€â”€ test_web_trading.py
```

## ğŸ¯ æµ‹è¯•åˆ†ç±»

### ç³»ç»Ÿçº§æµ‹è¯• (`system/`)
æµ‹è¯•æ•´ä¸ªARBIGç³»ç»Ÿçš„åŸºç¡€åŠŸèƒ½å’ŒæœåŠ¡çŠ¶æ€

- **`simple_system_test.py`** - åŸºç¡€ç³»ç»Ÿå¥åº·æ£€æŸ¥
  - æœåŠ¡è¿›ç¨‹çŠ¶æ€
  - ç«¯å£ç›‘å¬çŠ¶æ€
  - APIå“åº”æµ‹è¯•
  - é…ç½®æ–‡ä»¶æ£€æŸ¥

- **`test_non_trading_functions.py`** - éäº¤æ˜“æ—¶é—´åŠŸèƒ½æµ‹è¯•
  - æœåŠ¡å¥åº·çŠ¶æ€
  - APIæ¥å£æµ‹è¯•
  - æ•°æ®åº“è¿æ¥
  - é…ç½®æ–‡ä»¶éªŒè¯

- **`test_service_connection.py`** - æœåŠ¡è¿æ¥çŠ¶æ€æµ‹è¯•
  - å¤šç«¯å£è¿æ¥æ£€æŸ¥
  - APIæ–‡æ¡£å¯è®¿é—®æ€§
  - æœåŠ¡å“åº”çŠ¶æ€
  - è¿æ¥æ•…éšœè¯Šæ–­

### ç­–ç•¥ç›¸å…³æµ‹è¯• (`strategy/`)
æµ‹è¯•ç­–ç•¥ç®¡ç†ç³»ç»Ÿçš„å„é¡¹åŠŸèƒ½

- **`test_strategy_management.py`** - ç­–ç•¥ç®¡ç†ç³»ç»Ÿæµ‹è¯•
  - ç­–ç•¥æ³¨å†Œ/å¯åœ
  - æ€§èƒ½ç»Ÿè®¡åŠŸèƒ½
  - ç”Ÿå‘½å‘¨æœŸç®¡ç†
  - Webç•Œé¢ä»£ç†

### é›†æˆæµ‹è¯• (`integration/`)
æµ‹è¯•å„ä¸ªæœåŠ¡ä¹‹é—´çš„é›†æˆå’Œåä½œ

- å¾…æ·»åŠ ï¼šç«¯åˆ°ç«¯æµ‹è¯•
- å¾…æ·»åŠ ï¼šäº¤æ˜“æµç¨‹æµ‹è¯•
- å¾…æ·»åŠ ï¼šæ•°æ®æµæµ‹è¯•

### é—ç•™æµ‹è¯• (`legacy/`)
ä¿ç•™çš„å†å²æµ‹è¯•æ–‡ä»¶ï¼Œä¸»è¦ç”¨äºå‚è€ƒ

- `ctp_connection_test.py` - CTPè¿æ¥æµ‹è¯•
- `test_order_placement.py` - è®¢å•ä¸‹å•æµ‹è¯•
- `test_web_trading.py` - Webäº¤æ˜“æµ‹è¯•
- ç­‰ç­‰...

## ğŸš€ è¿è¡Œæµ‹è¯•

### è¿è¡Œæ‰€æœ‰æµ‹è¯•
```bash
cd /root/ARBIG
python tests/run_all_tests.py
```

### è¿è¡Œç‰¹å®šç±»åˆ«æµ‹è¯•
```bash
# ç³»ç»Ÿæµ‹è¯•
python tests/system/simple_system_test.py
python tests/system/test_non_trading_functions.py

# ç­–ç•¥æµ‹è¯•
python tests/strategy/test_strategy_management.py
```

### è¿è¡Œå•ä¸ªæµ‹è¯•
```bash
# åŸºç¡€ç³»ç»Ÿæµ‹è¯•
python tests/system/simple_system_test.py

# ç­–ç•¥ç®¡ç†æµ‹è¯•
python tests/strategy/test_strategy_management.py
```

## ğŸ“‹ æµ‹è¯•å‰å‡†å¤‡

### åŸºç¡€è¦æ±‚
- Python 3.8+ ç¯å¢ƒ
- å·²å®‰è£…é¡¹ç›®ä¾èµ– (`pip install -r requirements.txt`)
- æ•°æ®åº“æœåŠ¡è¿è¡Œä¸­ (MySQL)

### æœåŠ¡å¯åŠ¨
```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
python scripts/start_all_services.py

# æˆ–æ‰‹åŠ¨å¯åŠ¨
cd services/trading_service && python main.py &
cd services/strategy_service && python main.py &
cd services/web_admin_service && python main.py --port 8080 &
```

### ç¯å¢ƒé…ç½®
ç¡®ä¿ä»¥ä¸‹é…ç½®æ­£ç¡®ï¼š
- `config/config.yaml` - åŸºç¡€é…ç½®
- æ•°æ®åº“è¿æ¥å‚æ•°
- æœåŠ¡ç«¯å£é…ç½®

## ğŸ“Š æµ‹è¯•æŠ¥å‘Š

æµ‹è¯•ç»“æœä¼šä¿å­˜åˆ° `logs/` ç›®å½•ï¼š
- `logs/simple_test_YYYYMMDD_HHMMSS.json` - åŸºç¡€æµ‹è¯•ç»“æœ
- `logs/strategy_management_test_YYYYMMDD_HHMMSS.json` - ç­–ç•¥æµ‹è¯•ç»“æœ
- `logs/test_results_YYYYMMDD_HHMMSS.json` - è¯¦ç»†æµ‹è¯•ç»“æœ

## ğŸ” æµ‹è¯•è¦†ç›–èŒƒå›´

### âœ… å·²è¦†ç›–åŠŸèƒ½
- æœåŠ¡å¯åŠ¨å’Œå¥åº·æ£€æŸ¥
- åŸºç¡€APIæ¥å£æµ‹è¯•
- ç­–ç•¥ç®¡ç†åŠŸèƒ½æµ‹è¯•
- æ€§èƒ½ç»Ÿè®¡åŠŸèƒ½æµ‹è¯•
- Webç•Œé¢ä»£ç†æµ‹è¯•

### ğŸ”„ å¾…æ·»åŠ æµ‹è¯•
- CTPè¿æ¥å’Œäº¤æ˜“åŠŸèƒ½æµ‹è¯• (éœ€äº¤æ˜“æ—¶é—´)
- æ•°æ®åº“CRUDæ“ä½œæµ‹è¯•
- WebSocketå®æ—¶æ•°æ®æµ‹è¯•
- é”™è¯¯å¤„ç†å’Œå¼‚å¸¸æ¢å¤æµ‹è¯•
- æ€§èƒ½å’Œå‹åŠ›æµ‹è¯•

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æœåŠ¡è¿æ¥å¤±è´¥**
   - æ£€æŸ¥æœåŠ¡æ˜¯å¦å¯åŠ¨ï¼š`ps aux | grep python`
   - æ£€æŸ¥ç«¯å£å ç”¨ï¼š`netstat -tlnp | grep 800[12]`
   - æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

2. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   - æ£€æŸ¥MySQLæœåŠ¡çŠ¶æ€ï¼š`systemctl status mysql`
   - éªŒè¯è¿æ¥å‚æ•°ï¼š`config/database.yaml`
   - æ£€æŸ¥æ•°æ®åº“æƒé™

3. **æ¨¡å—å¯¼å…¥é”™è¯¯**
   - ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œæµ‹è¯•
   - æ£€æŸ¥Pythonè·¯å¾„è®¾ç½®
   - éªŒè¯ä¾èµ–åŒ…å®‰è£…

4. **APIå“åº”è¶…æ—¶**
   - æ£€æŸ¥æœåŠ¡è´Ÿè½½
   - å¢åŠ è¶…æ—¶æ—¶é—´è®¾ç½®
   - æŸ¥çœ‹æœåŠ¡æ—¥å¿—ï¼š`logs/*.log`

### æ—¥å¿—æŸ¥çœ‹
```bash
# æŸ¥çœ‹æœ€æ–°æµ‹è¯•æ—¥å¿—
ls -la logs/test_* | tail -5

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
tail -f logs/trading_service.log
tail -f logs/strategy_service.log
tail -f logs/web_admin_service.log
```

## ğŸ“ æµ‹è¯•å¼€å‘æŒ‡å—

### æ·»åŠ æ–°æµ‹è¯•
1. ç¡®å®šæµ‹è¯•ç±»åˆ« (system/strategy/integration)
2. åˆ›å»ºæµ‹è¯•æ–‡ä»¶ï¼Œç»§æ‰¿ç›¸åº”çš„æµ‹è¯•åŸºç±»
3. å®ç°æµ‹è¯•æ–¹æ³•ï¼Œéµå¾ªå‘½åçº¦å®š
4. æ·»åŠ å¿…è¦çš„æ–‡æ¡£å’Œæ³¨é‡Š
5. æ›´æ–°æœ¬READMEæ–‡æ¡£

### æµ‹è¯•å‘½åçº¦å®š
- æµ‹è¯•æ–‡ä»¶ï¼š`test_*.py`
- æµ‹è¯•ç±»ï¼š`*Tester`
- æµ‹è¯•æ–¹æ³•ï¼š`test_*()`
- è¾…åŠ©æ–¹æ³•ï¼š`_helper_*()`

### æœ€ä½³å®è·µ
- æ¯ä¸ªæµ‹è¯•åº”è¯¥ç‹¬ç«‹è¿è¡Œ
- æµ‹è¯•å‰æ¸…ç†ç¯å¢ƒï¼Œæµ‹è¯•åæ¢å¤çŠ¶æ€
- ä½¿ç”¨æœ‰æ„ä¹‰çš„æ–­è¨€å’Œé”™è¯¯æ¶ˆæ¯
- æ·»åŠ é€‚å½“çš„è¶…æ—¶å’Œé‡è¯•æœºåˆ¶
- è®°å½•è¯¦ç»†çš„æµ‹è¯•æ—¥å¿—