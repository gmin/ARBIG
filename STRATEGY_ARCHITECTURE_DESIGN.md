# ç­–ç•¥æž¶æž„é‡æ–°è®¾è®¡æ–¹æ¡ˆ

## ðŸŽ¯ è®¾è®¡åŽŸåˆ™

### 1. åˆ†å±‚è§£è€¦
- **ä¿¡å·å±‚**: çº¯ç²¹çš„æŠ€æœ¯åˆ†æžå’Œä¿¡å·ç”Ÿæˆ
- **å†³ç­–å±‚**: åŸºäºŽä¿¡å·çš„äº¤æ˜“å†³ç­–é€»è¾‘
- **æ‰§è¡Œå±‚**: è®¢å•ç”Ÿæˆå’Œé£ŽæŽ§æ£€æŸ¥
- **ç®¡ç†å±‚**: ç­–ç•¥ç”Ÿå‘½å‘¨æœŸå’ŒçŠ¶æ€ç®¡ç†

### 2. å•ä¸€èŒè´£
- æ¯ä¸ªç»„ä»¶åªè´Ÿè´£ä¸€ä¸ªæ˜Žç¡®çš„åŠŸèƒ½
- ç­–ç•¥åªå…³æ³¨ä¿¡å·ç”Ÿæˆï¼Œä¸å¤„ç†æ‰§è¡Œç»†èŠ‚
- æ‰§è¡Œå¼•æ“Žåªå…³æ³¨è®¢å•å¤„ç†ï¼Œä¸å…³å¿ƒç­–ç•¥é€»è¾‘

### 3. å¯æµ‹è¯•æ€§
- æ¯ä¸ªç»„ä»¶éƒ½å¯ä»¥ç‹¬ç«‹æµ‹è¯•
- æ”¯æŒåŽ†å²æ•°æ®å›žæµ‹
- æ”¯æŒæ¨¡æ‹ŸçŽ¯å¢ƒéªŒè¯

## ðŸ—ï¸ æ–°æž¶æž„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç­–ç•¥ç®¡ç†å±‚ (Strategy Manager)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  - ç­–ç•¥ç”Ÿå‘½å‘¨æœŸç®¡ç†                                          â”‚
â”‚  - ç­–ç•¥é…ç½®ç®¡ç†                                              â”‚
â”‚  - ç­–ç•¥çŠ¶æ€ç›‘æŽ§                                              â”‚
â”‚  - ç­–ç•¥æ€§èƒ½ç»Ÿè®¡                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç­–ç•¥æ‰§è¡Œå¼•æ“Ž (Strategy Engine)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  - æŽ¥æ”¶å¸‚åœºæ•°æ®                                              â”‚
â”‚  - è°ƒç”¨ç­–ç•¥è®¡ç®—                                              â”‚
â”‚  - å¤„ç†ç­–ç•¥ä¿¡å·                                              â”‚
â”‚  - é£ŽæŽ§æ£€æŸ¥                                                  â”‚
â”‚  - è®¢å•ç”Ÿæˆ                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç­–ç•¥å®žä¾‹ (Strategy Instance)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚   ä¿¡å·ç”Ÿæˆå™¨     â”‚  â”‚   å†³ç­–å¼•æ“Ž       â”‚  â”‚   é£ŽæŽ§æ¨¡å—       â”‚â”‚
â”‚  â”‚ Signal Generator â”‚  â”‚ Decision Engine â”‚  â”‚ Risk Controller â”‚â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚â”‚
â”‚  â”‚ - æŠ€æœ¯æŒ‡æ ‡è®¡ç®—   â”‚  â”‚ - ä¿¡å·è¿‡æ»¤       â”‚  â”‚ - ä»“ä½é™åˆ¶       â”‚â”‚
â”‚  â”‚ - æ¨¡å¼è¯†åˆ«       â”‚  â”‚ - æ—¶æœºé€‰æ‹©       â”‚  â”‚ - æ­¢æŸæ­¢ç›ˆ       â”‚â”‚
â”‚  â”‚ - ä¿¡å·ç”Ÿæˆ       â”‚  â”‚ - ä»“ä½è®¡ç®—       â”‚  â”‚ - é£Žé™©è¯„ä¼°       â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    äº¤æ˜“æ‰§è¡Œå±‚ (Trading Executor)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  - è®¢å•è·¯ç”±                                                  â”‚
â”‚  - è®¢å•ç®¡ç†                                                  â”‚
â”‚  - æˆäº¤å›žæŠ¥                                                  â”‚
â”‚  - æŒä»“æ›´æ–°                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸ“‹ ç»„ä»¶è¯¦ç»†è®¾è®¡

### 1. ä¿¡å·ç”Ÿæˆå™¨ (Signal Generator)

**èŒè´£**: çº¯ç²¹çš„æŠ€æœ¯åˆ†æžï¼Œç”Ÿæˆä¹°å–ä¿¡å·

```python
class SignalGenerator:
    def __init__(self, config):
        self.indicators = self._init_indicators(config)
    
    def generate_signal(self, market_data) -> Signal:
        """ç”Ÿæˆäº¤æ˜“ä¿¡å·"""
        # åªå…³æ³¨æŠ€æœ¯åˆ†æžï¼Œä¸è€ƒè™‘ä»“ä½ã€èµ„é‡‘ç­‰
        pass
    
    def _calculate_ma(self, prices, period):
        """è®¡ç®—ç§»åŠ¨å¹³å‡çº¿"""
        pass
    
    def _calculate_rsi(self, prices, period):
        """è®¡ç®—RSI"""
        pass
```

### 2. å†³ç­–å¼•æ“Ž (Decision Engine)

**èŒè´£**: åŸºäºŽä¿¡å·åšå‡ºäº¤æ˜“å†³ç­–

```python
class DecisionEngine:
    def __init__(self, config):
        self.filters = self._init_filters(config)
        self.position_sizer = PositionSizer(config)
    
    def make_decision(self, signal, market_context, portfolio_context) -> Decision:
        """åŸºäºŽä¿¡å·å’Œä¸Šä¸‹æ–‡åšå‡ºå†³ç­–"""
        # ä¿¡å·è¿‡æ»¤
        if not self._filter_signal(signal, market_context):
            return None
        
        # è®¡ç®—ä»“ä½
        position = self.position_sizer.calculate(signal, portfolio_context)
        
        return Decision(action=signal.action, quantity=position, price=signal.price)
```

### 3. é£ŽæŽ§æ¨¡å— (Risk Controller)

**èŒè´£**: é£Žé™©æ£€æŸ¥å’ŒæŽ§åˆ¶

```python
class RiskController:
    def __init__(self, config):
        self.max_position = config.get('max_position')
        self.stop_loss = config.get('stop_loss')
        self.max_drawdown = config.get('max_drawdown')
    
    def check_risk(self, decision, portfolio_state) -> bool:
        """æ£€æŸ¥å†³ç­–æ˜¯å¦ç¬¦åˆé£ŽæŽ§è¦æ±‚"""
        # ä»“ä½æ£€æŸ¥
        # æ­¢æŸæ£€æŸ¥
        # å›žæ’¤æ£€æŸ¥
        pass
```

### 4. ç­–ç•¥å®žä¾‹ (Strategy Instance)

**èŒè´£**: ç»„åˆå„ä¸ªç»„ä»¶ï¼Œå®žçŽ°å®Œæ•´ç­–ç•¥é€»è¾‘

```python
class StrategyInstance:
    def __init__(self, name, config):
        self.name = name
        self.signal_generator = SignalGenerator(config['signals'])
        self.decision_engine = DecisionEngine(config['decisions'])
        self.risk_controller = RiskController(config['risk'])
        
        self.state = StrategyState()
    
    def process_market_data(self, market_data) -> List[Order]:
        """å¤„ç†å¸‚åœºæ•°æ®ï¼Œè¿”å›žè®¢å•åˆ—è¡¨"""
        # 1. ç”Ÿæˆä¿¡å·
        signal = self.signal_generator.generate_signal(market_data)
        if not signal:
            return []
        
        # 2. åšå‡ºå†³ç­–
        decision = self.decision_engine.make_decision(
            signal, market_data, self.state.portfolio
        )
        if not decision:
            return []
        
        # 3. é£ŽæŽ§æ£€æŸ¥
        if not self.risk_controller.check_risk(decision, self.state):
            return []
        
        # 4. ç”Ÿæˆè®¢å•
        orders = self._create_orders(decision)
        
        # 5. æ›´æ–°çŠ¶æ€
        self.state.update_pending_orders(orders)
        
        return orders
```

## ðŸ”„ ç­–ç•¥æ‰§è¡Œæµç¨‹

### 1. æ•°æ®æµ
```
å¸‚åœºæ•°æ® â†’ ç­–ç•¥å®žä¾‹ â†’ ä¿¡å·ç”Ÿæˆ â†’ å†³ç­–åˆ¶å®š â†’ é£ŽæŽ§æ£€æŸ¥ â†’ è®¢å•ç”Ÿæˆ â†’ äº¤æ˜“æ‰§è¡Œ
```

### 2. çŠ¶æ€ç®¡ç†
```
ç­–ç•¥çŠ¶æ€ â† æˆäº¤å›žæŠ¥ â† è®¢å•çŠ¶æ€ â† äº¤æ˜“æ‰§è¡Œ
```

### 3. ç›‘æŽ§åé¦ˆ
```
æ€§èƒ½ç»Ÿè®¡ â† ç­–ç•¥çŠ¶æ€ â† æŒä»“å˜åŒ– â† æˆäº¤è®°å½•
```

## ðŸŽ›ï¸ é…ç½®é©±åŠ¨è®¾è®¡

### ç­–ç•¥é…ç½®ç¤ºä¾‹
```yaml
strategy:
  name: "SHFE_MA_Strategy"
  type: "trend_following"
  
  signals:
    indicators:
      - type: "MA"
        short_period: 5
        long_period: 20
      - type: "RSI"
        period: 14
        overbought: 70
        oversold: 30
    
    rules:
      - condition: "MA_short > MA_long AND RSI < 70"
        signal: "BUY"
      - condition: "MA_short < MA_long AND RSI > 30"
        signal: "SELL"
  
  decisions:
    filters:
      - type: "time_filter"
        start_time: "09:00"
        end_time: "15:00"
      - type: "volatility_filter"
        min_volatility: 0.01
        max_volatility: 0.05
    
    position_sizing:
      method: "fixed_fraction"
      fraction: 0.02
      max_position: 1000
  
  risk:
    max_position: 1000
    stop_loss: 0.02
    take_profit: 0.05
    max_drawdown: 0.10
    max_daily_loss: 0.05
```

## ðŸ§ª æµ‹è¯•ç­–ç•¥

### 1. å•å…ƒæµ‹è¯•
```python
def test_signal_generator():
    generator = SignalGenerator(config)
    signal = generator.generate_signal(mock_data)
    assert signal.action == "BUY"
    assert signal.strength > 0.5

def test_decision_engine():
    engine = DecisionEngine(config)
    decision = engine.make_decision(mock_signal, mock_context, mock_portfolio)
    assert decision.quantity > 0
```

### 2. é›†æˆæµ‹è¯•
```python
def test_strategy_instance():
    strategy = StrategyInstance("test", config)
    orders = strategy.process_market_data(mock_market_data)
    assert len(orders) > 0
    assert orders[0].symbol == "au2509"
```

### 3. å›žæµ‹éªŒè¯
```python
def test_backtest():
    strategy = StrategyInstance("backtest", config)
    backtest_engine = BacktestEngine(historical_data)
    results = backtest_engine.run(strategy)
    
    assert results.total_return > 0
    assert results.sharpe_ratio > 1.0
    assert results.max_drawdown < 0.1
```

## ðŸš€ å®žæ–½ä¼˜åŠ¿

### 1. æ¸…æ™°çš„èŒè´£åˆ†ç¦»
- æ¯ä¸ªç»„ä»¶èŒè´£æ˜Žç¡®ï¼Œæ˜“äºŽç†è§£å’Œç»´æŠ¤
- å¯ä»¥ç‹¬ç«‹å¼€å‘å’Œæµ‹è¯•å„ä¸ªç»„ä»¶
- ä¾¿äºŽå›¢é˜Ÿåä½œå¼€å‘

### 2. é«˜åº¦å¯é…ç½®
- é€šè¿‡é…ç½®æ–‡ä»¶æŽ§åˆ¶ç­–ç•¥è¡Œä¸º
- æ— éœ€ä¿®æ”¹ä»£ç å³å¯è°ƒæ•´å‚æ•°
- æ”¯æŒA/Bæµ‹è¯•å’Œå‚æ•°ä¼˜åŒ–

### 3. æ˜“äºŽæ‰©å±•
- æ–°å¢žæŒ‡æ ‡åªéœ€å®žçŽ°SignalGeneratoræŽ¥å£
- æ–°å¢žå†³ç­–é€»è¾‘åªéœ€æ‰©å±•DecisionEngine
- æ–°å¢žé£ŽæŽ§è§„åˆ™åªéœ€æ‰©å±•RiskController

### 4. ä¾¿äºŽç›‘æŽ§
- æ¯ä¸ªçŽ¯èŠ‚éƒ½æœ‰æ˜Žç¡®çš„è¾“å…¥è¾“å‡º
- å¯ä»¥ç›‘æŽ§æ¯ä¸ªç»„ä»¶çš„æ€§èƒ½
- ä¾¿äºŽé—®é¢˜å®šä½å’Œè°ƒè¯•

## ðŸŽ¯ ä¸‹ä¸€æ­¥å®žæ–½è®¡åˆ’

### é˜¶æ®µ1: é‡æž„çŽ°æœ‰ç­–ç•¥
1. å°†SHFEç­–ç•¥æŒ‰æ–°æž¶æž„é‡æž„
2. å®žçŽ°åŸºç¡€çš„ä¿¡å·ç”Ÿæˆå™¨
3. å®žçŽ°ç®€å•çš„å†³ç­–å¼•æ“Ž

### é˜¶æ®µ2: å®Œå–„æ‰§è¡Œå¼•æ“Ž
1. å®žçŽ°ç­–ç•¥æ‰§è¡Œå¼•æ“Ž
2. é›†æˆé£ŽæŽ§æ¨¡å—
3. å®Œå–„è®¢å•ç®¡ç†

### é˜¶æ®µ3: å¢žå¼ºåŠŸèƒ½
1. å®žçŽ°å›žæµ‹æ¡†æž¶
2. æ·»åŠ æ€§èƒ½ç›‘æŽ§
3. æ”¯æŒå¤šç­–ç•¥å¹¶è¡Œ

è¿™ä¸ªæ–°æž¶æž„å°†å¤§å¤§æé«˜ç­–ç•¥çš„å¯ç»´æŠ¤æ€§ã€å¯æµ‹è¯•æ€§å’Œå¯æ‰©å±•æ€§ã€‚
