<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>紧急调试页面</title>
    <style>
        body { 
            font-family: Arial; 
            margin: 20px; 
            background: #f0f0f0; 
        }
        .box { 
            background: white; 
            padding: 20px; 
            margin: 10px 0; 
            border: 2px solid #333; 
        }
        .red { background: #ffeeee; border-color: #ff0000; }
        .green { background: #eeffee; border-color: #00ff00; }
        .blue { background: #eeeeff; border-color: #0000ff; }
    </style>
</head>
<body>
    <div class="box red">
        <h1>🚨 紧急调试页面</h1>
        <p><strong>如果您能看到这个页面，说明基础HTML/CSS正常工作</strong></p>
    </div>
    
    <div class="box green">
        <h2>✅ 基础信息</h2>
        <p>当前时间: <span id="time">JavaScript未执行</span></p>
        <p>页面URL: <span id="url">JavaScript未执行</span></p>
    </div>
    
    <div class="box blue">
        <h2>🔍 JavaScript测试</h2>
        <p>JavaScript状态: <span id="js-status">未执行</span></p>
        <button onclick="testJS()">点击测试JavaScript</button>
    </div>
    
    <div class="box">
        <h2>📋 调试日志</h2>
        <div id="log" style="background: #f9f9f9; padding: 10px; border: 1px solid #ccc; min-height: 100px; font-family: monospace;"></div>
    </div>
    
    <div class="box">
        <h2>🔗 其他页面</h2>
        <p>
            <a href="/test_simple.html">简单测试页面</a> | 
            <a href="/api/v1/system/status">系统状态JSON</a> | 
            <a href="/">返回主页</a>
        </p>
    </div>

    <script>
        // 立即执行的代码
        console.log('紧急调试页面JavaScript开始执行');
        
        // 日志函数
        function log(message) {
            console.log(message);
            const logDiv = document.getElementById('log');
            if (logDiv) {
                logDiv.innerHTML += new Date().toLocaleTimeString() + ': ' + message + '<br>';
            }
        }
        
        // 页面加载完成
        window.addEventListener('load', function() {
            log('✅ 页面加载完成');
            
            // 更新基础信息
            const timeSpan = document.getElementById('time');
            const urlSpan = document.getElementById('url');
            const jsStatus = document.getElementById('js-status');
            
            if (timeSpan) timeSpan.textContent = new Date().toLocaleString();
            if (urlSpan) urlSpan.textContent = window.location.href;
            if (jsStatus) jsStatus.textContent = '✅ 正常工作';
            
            log('✅ 基础信息更新完成');
            
            // 每秒更新时间
            setInterval(function() {
                if (timeSpan) timeSpan.textContent = new Date().toLocaleString();
            }, 1000);
            
            log('✅ 定时器设置完成');
        });
        
        // 测试JavaScript函数
        function testJS() {
            log('🧪 开始JavaScript测试');
            
            try {
                // 基础运算
                const result = 2 + 2;
                log('基础运算: 2 + 2 = ' + result);
                
                // DOM操作
                const testDiv = document.createElement('div');
                testDiv.textContent = '测试元素';
                log('DOM操作: 创建元素成功');
                
                // JSON操作
                const obj = {test: 'value'};
                const json = JSON.stringify(obj);
                log('JSON操作: ' + json);
                
                // 异步操作测试
                setTimeout(function() {
                    log('✅ 异步操作正常');
                }, 100);
                
                log('✅ JavaScript测试完成');
                
            } catch (error) {
                log('❌ JavaScript测试失败: ' + error.message);
            }
        }
        
        // 错误捕获
        window.addEventListener('error', function(event) {
            log('❌ JavaScript错误: ' + event.message + ' (行号: ' + event.lineno + ')');
        });
        
        window.addEventListener('unhandledrejection', function(event) {
            log('❌ Promise错误: ' + event.reason);
        });
        
        // 立即记录初始状态
        log('🚀 紧急调试页面JavaScript初始化完成');
    </script>
</body>
</html>
