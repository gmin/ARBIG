# æµ‹è¯•ç›®å½•é‡ç»„æ€»ç»“

## ğŸ“… é‡ç»„æ—¶é—´
**æ—¥æœŸ**: 2025-08-17  
**æ“ä½œ**: æµ‹è¯•è„šæœ¬ç›®å½•ç»“æ„é‡ç»„

## ğŸ¯ é‡ç»„ç›®æ ‡
å°†æ‰€æœ‰æµ‹è¯•è„šæœ¬ç»Ÿä¸€ç§»åŠ¨åˆ° `tests/` ç›®å½•ï¼Œå»ºç«‹æ¸…æ™°çš„æµ‹è¯•åˆ†ç±»ç»“æ„ï¼Œæé«˜é¡¹ç›®ç»„ç»‡æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

## ğŸ“ æ–°çš„ç›®å½•ç»“æ„

### é‡ç»„å‰
```
scripts/
â”œâ”€â”€ test_strategy_management.py     # ç­–ç•¥ç®¡ç†æµ‹è¯•
â”œâ”€â”€ simple_system_test.py          # ç³»ç»Ÿæµ‹è¯•
â”œâ”€â”€ test_non_trading_functions.py  # éäº¤æ˜“åŠŸèƒ½æµ‹è¯•
â””â”€â”€ (å…¶ä»–å·¥å…·è„šæœ¬)

tests/
â”œâ”€â”€ ctp_connection_test.py         # å„ç§é—ç•™æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ test_account_query.py
â”œâ”€â”€ test_frontend.py
â”œâ”€â”€ test_history_query.py
â”œâ”€â”€ test_order_placement.py
â”œâ”€â”€ test_web_trading.py
â”œâ”€â”€ run_all_tests.py
â””â”€â”€ README.md
```

### é‡ç»„å
```
scripts/                           # ä»…ä¿ç•™å·¥å…·è„šæœ¬
â”œâ”€â”€ db_manager.py                  # æ•°æ®åº“ç®¡ç†å·¥å…·
â”œâ”€â”€ init_database.py               # æ•°æ®åº“åˆå§‹åŒ–
â”œâ”€â”€ start_all_services.py          # æœåŠ¡å¯åŠ¨è„šæœ¬
â””â”€â”€ watch_logs.py                  # æ—¥å¿—ç›‘æ§å·¥å…·

tests/                             # æ‰€æœ‰æµ‹è¯•è„šæœ¬
â”œâ”€â”€ README.md                      # æµ‹è¯•å¥—ä»¶è¯´æ˜
â”œâ”€â”€ run_all_tests.py              # åŸæœ‰æµ‹è¯•è¿è¡Œå™¨
â”œâ”€â”€ run_tests.py                   # æ–°æµ‹è¯•è¿è¡Œå™¨
â”œâ”€â”€ system/                        # ç³»ç»Ÿçº§æµ‹è¯•
â”‚   â”œâ”€â”€ simple_system_test.py      # åŸºç¡€ç³»ç»Ÿæµ‹è¯•
â”‚   â””â”€â”€ test_non_trading_functions.py  # éäº¤æ˜“åŠŸèƒ½æµ‹è¯•
â”œâ”€â”€ strategy/                      # ç­–ç•¥ç›¸å…³æµ‹è¯•
â”‚   â””â”€â”€ test_strategy_management.py    # ç­–ç•¥ç®¡ç†æµ‹è¯•
â”œâ”€â”€ integration/                   # é›†æˆæµ‹è¯• (å¾…æ·»åŠ )
â””â”€â”€ legacy/                        # é—ç•™æµ‹è¯•æ–‡ä»¶
    â”œâ”€â”€ ctp_connection_test.py
    â”œâ”€â”€ test_account_query.py
    â”œâ”€â”€ test_frontend.py
    â”œâ”€â”€ test_history_query.py
    â”œâ”€â”€ test_order_placement.py
    â””â”€â”€ test_web_trading.py
```

## ğŸ”„ æ‰§è¡Œçš„æ“ä½œ

### 1. åˆ›å»ºæµ‹è¯•å­ç›®å½•
```bash
mkdir -p tests/system tests/strategy tests/integration tests/legacy
```

### 2. ç§»åŠ¨æµ‹è¯•è„šæœ¬
- `scripts/test_strategy_management.py` â†’ `tests/strategy/`
- `scripts/simple_system_test.py` â†’ `tests/system/`
- `scripts/test_non_trading_functions.py` â†’ `tests/system/`
- `tests/test_*.py` â†’ `tests/legacy/`
- `tests/ctp_connection_test.py` â†’ `tests/legacy/`

### 3. æ›´æ–°è·¯å¾„å¼•ç”¨
ä¿®å¤ç§»åŠ¨åçš„æµ‹è¯•è„šæœ¬ä¸­çš„Pythonè·¯å¾„å¼•ç”¨ï¼š
```python
# ä¿®æ”¹å‰
sys.path.append(os.path.join(os.path.dirname(__file__), '..'))

# ä¿®æ”¹å (é€‚åº”æ–°çš„ç›®å½•å±‚çº§)
sys.path.append(os.path.join(os.path.dirname(__file__), '../..'))
```

### 4. åˆ›å»ºæ–°çš„æµ‹è¯•è¿è¡Œå™¨
- åˆ›å»º `tests/run_tests.py` - æ”¯æŒåˆ†ç±»è¿è¡Œæµ‹è¯•
- æ›´æ–° `tests/README.md` - è¯¦ç»†çš„æµ‹è¯•è¯´æ˜æ–‡æ¡£

## ğŸ¯ æµ‹è¯•åˆ†ç±»è¯´æ˜

### System Tests (ç³»ç»Ÿçº§æµ‹è¯•)
æµ‹è¯•æ•´ä¸ªARBIGç³»ç»Ÿçš„åŸºç¡€åŠŸèƒ½ï¼š
- **æœåŠ¡çŠ¶æ€æ£€æŸ¥**: è¿›ç¨‹ã€ç«¯å£ã€è¿æ¥
- **APIæ¥å£æµ‹è¯•**: åŸºç¡€APIå“åº”
- **é…ç½®éªŒè¯**: é…ç½®æ–‡ä»¶å®Œæ•´æ€§
- **å¥åº·æ£€æŸ¥**: ç³»ç»Ÿæ•´ä½“å¥åº·çŠ¶æ€

### Strategy Tests (ç­–ç•¥ç›¸å…³æµ‹è¯•)
æµ‹è¯•ç­–ç•¥ç®¡ç†ç³»ç»ŸåŠŸèƒ½ï¼š
- **ç­–ç•¥ç”Ÿå‘½å‘¨æœŸ**: æ³¨å†Œã€å¯åŠ¨ã€åœæ­¢
- **æ€§èƒ½ç»Ÿè®¡**: ç›ˆäºã€èƒœç‡ã€é£é™©æŒ‡æ ‡
- **å‚æ•°ç®¡ç†**: å‚æ•°æ›´æ–°ã€éªŒè¯
- **Webç•Œé¢**: ç­–ç•¥ç®¡ç†ç•Œé¢åŠŸèƒ½

### Integration Tests (é›†æˆæµ‹è¯•)
æµ‹è¯•å„æœåŠ¡é—´çš„é›†æˆï¼š
- **ç«¯åˆ°ç«¯æµç¨‹**: å®Œæ•´äº¤æ˜“æµç¨‹æµ‹è¯•
- **æœåŠ¡åä½œ**: å¾®æœåŠ¡é—´é€šä¿¡æµ‹è¯•
- **æ•°æ®ä¸€è‡´æ€§**: è·¨æœåŠ¡æ•°æ®åŒæ­¥æµ‹è¯•
- (å¾…æ·»åŠ å…·ä½“æµ‹è¯•)

### Legacy Tests (é—ç•™æµ‹è¯•)
ä¿ç•™çš„å†å²æµ‹è¯•æ–‡ä»¶ï¼š
- **CTPåŠŸèƒ½**: è¿æ¥ã€æŸ¥è¯¢ã€äº¤æ˜“æµ‹è¯•
- **Webç•Œé¢**: å‰ç«¯åŠŸèƒ½æµ‹è¯•
- **äº¤æ˜“åŠŸèƒ½**: è®¢å•ã€æŒä»“æµ‹è¯•
- (ä¸»è¦ç”¨äºå‚è€ƒï¼Œéœ€è¦æ—¶å¯ä»¥è¿ç§»åˆ°æ–°åˆ†ç±»)

## ğŸš€ æ–°çš„æµ‹è¯•è¿è¡Œæ–¹å¼

### ä½¿ç”¨æ–°æµ‹è¯•è¿è¡Œå™¨
```bash
# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨æµ‹è¯•
python tests/run_tests.py --list

# è¿è¡Œç³»ç»Ÿæµ‹è¯•
python tests/run_tests.py --category system

# è¿è¡Œç­–ç•¥æµ‹è¯•
python tests/run_tests.py --category strategy

# è¿è¡Œæ‰€æœ‰ä¸»è¦æµ‹è¯•
python tests/run_tests.py --all

# è¿è¡Œå•ä¸ªæµ‹è¯•
python tests/run_tests.py --test system/simple_system_test.py
```

### ä½¿ç”¨åŸæœ‰æµ‹è¯•è¿è¡Œå™¨
```bash
# è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
python tests/run_all_tests.py
```

### ç›´æ¥è¿è¡Œæµ‹è¯•
```bash
# ç³»ç»Ÿæµ‹è¯•
python tests/system/simple_system_test.py
python tests/system/test_non_trading_functions.py

# ç­–ç•¥æµ‹è¯•
python tests/strategy/test_strategy_management.py
```

## ğŸ“Š é‡ç»„æ•ˆæœ

### âœ… æ”¹è¿›æ•ˆæœ
1. **ç»“æ„æ¸…æ™°**: æµ‹è¯•æŒ‰åŠŸèƒ½åˆ†ç±»ï¼Œæ˜“äºæŸ¥æ‰¾å’Œç»´æŠ¤
2. **èŒè´£åˆ†ç¦»**: scriptsç›®å½•ä¸“æ³¨å·¥å…·è„šæœ¬ï¼Œtestsç›®å½•ä¸“æ³¨æµ‹è¯•
3. **æ‰©å±•æ€§å¥½**: æ–°å¢æµ‹è¯•å¯ä»¥è½»æ¾å½’ç±»åˆ°åˆé€‚ç›®å½•
4. **è¿è¡Œçµæ´»**: æ”¯æŒæŒ‰ç±»åˆ«è¿è¡Œæµ‹è¯•ï¼Œæé«˜æ•ˆç‡
5. **æ–‡æ¡£å®Œå–„**: è¯¦ç»†çš„æµ‹è¯•è¯´æ˜å’Œä½¿ç”¨æŒ‡å—

### ğŸ“ˆ æµ‹è¯•è¦†ç›–
- **ç³»ç»Ÿçº§**: 2ä¸ªæµ‹è¯•è„šæœ¬
- **ç­–ç•¥çº§**: 1ä¸ªæµ‹è¯•è„šæœ¬  
- **é›†æˆçº§**: å¾…æ·»åŠ 
- **é—ç•™**: 6ä¸ªå†å²æµ‹è¯•æ–‡ä»¶

### ğŸ¯ éªŒè¯ç»“æœ
æ–°æµ‹è¯•ç»“æ„å·²éªŒè¯å¯æ­£å¸¸å·¥ä½œï¼š
- âœ… æµ‹è¯•è¿è¡Œå™¨åŠŸèƒ½æ­£å¸¸
- âœ… è·¯å¾„å¼•ç”¨ä¿®å¤æ­£ç¡®
- âœ… åˆ†ç±»è¿è¡ŒåŠŸèƒ½æ­£å¸¸
- âœ… ç³»ç»Ÿæµ‹è¯•é€šè¿‡

## ğŸ”® åç»­è®¡åˆ’

### çŸ­æœŸç›®æ ‡
1. **å®Œå–„é›†æˆæµ‹è¯•**: æ·»åŠ ç«¯åˆ°ç«¯æµ‹è¯•ç”¨ä¾‹
2. **å¢å¼ºç­–ç•¥æµ‹è¯•**: æ›´å…¨é¢çš„ç­–ç•¥åŠŸèƒ½æµ‹è¯•
3. **æ€§èƒ½æµ‹è¯•**: æ·»åŠ ç³»ç»Ÿæ€§èƒ½å’Œå‹åŠ›æµ‹è¯•

### ä¸­æœŸç›®æ ‡
1. **è‡ªåŠ¨åŒ–æµ‹è¯•**: CI/CDé›†æˆï¼Œè‡ªåŠ¨è¿è¡Œæµ‹è¯•
2. **æµ‹è¯•æŠ¥å‘Š**: ç”Ÿæˆè¯¦ç»†çš„HTMLæµ‹è¯•æŠ¥å‘Š
3. **è¦†ç›–ç‡åˆ†æ**: ä»£ç æµ‹è¯•è¦†ç›–ç‡ç»Ÿè®¡

### é•¿æœŸç›®æ ‡
1. **æµ‹è¯•æ•°æ®ç®¡ç†**: æµ‹è¯•æ•°æ®çš„ç”Ÿæˆå’Œç®¡ç†
2. **æ¨¡æ‹Ÿç¯å¢ƒ**: å®Œæ•´çš„æµ‹è¯•ç¯å¢ƒæ­å»º
3. **å›å½’æµ‹è¯•**: ç‰ˆæœ¬å‡çº§æ—¶çš„å›å½’æµ‹è¯•å¥—ä»¶

## ğŸ’¡ æœ€ä½³å®è·µ

### æ·»åŠ æ–°æµ‹è¯•
1. ç¡®å®šæµ‹è¯•ç±»åˆ« (system/strategy/integration)
2. åœ¨å¯¹åº”ç›®å½•åˆ›å»ºæµ‹è¯•æ–‡ä»¶
3. éµå¾ªå‘½åçº¦å®š `test_*.py`
4. æ›´æ–° `tests/run_tests.py` ä¸­çš„æµ‹è¯•åˆ—è¡¨
5. æ·»åŠ å¿…è¦çš„æ–‡æ¡£è¯´æ˜

### æµ‹è¯•å¼€å‘è§„èŒƒ
1. **ç‹¬ç«‹æ€§**: æ¯ä¸ªæµ‹è¯•åº”è¯¥èƒ½ç‹¬ç«‹è¿è¡Œ
2. **æ¸…ç†**: æµ‹è¯•åæ¸…ç†ä¸´æ—¶æ•°æ®å’ŒçŠ¶æ€
3. **æ–‡æ¡£**: æ·»åŠ æ¸…æ™°çš„æµ‹è¯•è¯´æ˜å’Œæ³¨é‡Š
4. **é”™è¯¯å¤„ç†**: åˆé€‚çš„å¼‚å¸¸å¤„ç†å’Œé”™è¯¯ä¿¡æ¯
5. **è¶…æ—¶**: è®¾ç½®åˆç†çš„æµ‹è¯•è¶…æ—¶æ—¶é—´

è¿™æ¬¡æµ‹è¯•ç›®å½•é‡ç»„ä¸ºARBIGé¡¹ç›®å»ºç«‹äº†æ›´ä¸“ä¸šã€æ›´æ¸…æ™°çš„æµ‹è¯•ä½“ç³»ï¼Œä¸ºåç»­çš„åŠŸèƒ½å¼€å‘å’Œè´¨é‡ä¿è¯å¥ å®šäº†è‰¯å¥½åŸºç¡€ã€‚
